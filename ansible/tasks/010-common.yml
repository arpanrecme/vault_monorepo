---
- name: Vault Monorepo | Common | Execute bitwarden secrets export script
  run_once: true
  become: false
  delegate_to: localhost
  no_log: "{{ vault_mono_debug_no_log }}"
  ansible.builtin.command:
    argv:
      - "{{ vault_mono_local_file_bw_export_script }}"
  changed_when: false
  register: vault_mono_local_file_bw_export_script_command

- name: Vault Monorepo | Common | Get bitwarden secrets
  ansible.builtin.set_fact:
    vault_mono_bw_secrets: "{{ vault_mono_local_file_bw_export_script_command.stdout | from_json }}"

- name: Vault Monorepo | Common | Get Vault Config
  no_log: "{{ vault_mono_debug_no_log }}"
  become: false
  run_once: true
  delegate_to: localhost
  ansible.builtin.set_fact:
    vault_mono_global_config: "{{ lookup('ansible.builtin.file', vault_mono_local_file_global_config) | from_json }}"
